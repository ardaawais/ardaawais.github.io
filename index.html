<!DOCTYPE html>
<html>
<head>
	<meta charset = "utf-8">
    <title>Exhibition</title>
  <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>

     <style media="screen">

      /* Make the chart container fill the page using CSS. */
      #chart {
        position: fixed;
        left: 0px;
        right: 0px;
        top: 0px;
        bottom: 0px;
      }

      #login{
      	bottom:750px;
      	left:50px;
      	      display: inline-block;
      }

        .button2 {
      background-color: #3b5998;
      border: none;
      color: white;
      padding: 10px 60px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
      position:absolute;
      border-radius: 2px;
      top:200px;
      left:1000px;
    }


            .button3 {
      background-color: #000000;
      border: none;
      color: white;
      padding: 10px 60px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
      position:absolute;
      border-radius: 2px;
      top: 930px; 


    }

            .button4 {
      background-color: #000000;
      border: none;
      color: white;
      padding: 10px 60px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
      position:absolute;
      border-radius: 2px;
      top: 500px; 

    }


            .button5 {
      background-color: #FFFFFF;
      border: none;
      color: black;
      padding: 10px 60px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
      position:absolute;
      border-radius: 2px;
      top: 930px; 


    }




    .img{
      position:absolute;
      top:600px;
      left:60px;
    }



    p {
        
      margin-top: 1em;
      margin-bottom: 1em;
      position:absolute;
      top:150px;
      left:50px

    }

    </style>
</head>
<body>
<div id="chart"></div>
<script>

      var chartDiv = document.getElementById("chart");
      var svg = d3.select(chartDiv).append("svg");

    // Define the size of the canvas above so we can re-use it later to generate co-ordinates
    var width = chartDiv.clientWidth;
    var height = chartDiv.clientHeight; 

    // create our canvas
    var canvas = d3.select("body").append("svg")
      .attr("width", width)
      .attr("height", 1000); //how can I adjust this to be adjustable to someones data  


banner();

//initlise and setup facebook js sdk
  window.fbAsyncInit = function() {
    FB.init({
      appId            : '343061712934729',
      autoLogAppEvents : true,
      xfbml            : true,
      version          : 'v3.1'
    });


    FB.getLoginStatus(function(response) {
    	statusChangeCallback(response);
    });

};


  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));


         function statusChangeCallback(response){
         if(response.status === 'connected'){
           console.log('Logged in and authenticated');
           setElements(true);
           theProfile();
         } else {
           console.log('Not authenticated');
           setElements(false);
         }
       }

      function checkLoginState() {
      	location.reload(); 
        FB.getLoginStatus(function(response) {
          statusChangeCallback(response);
        });
      }

            function setElements(isLoggedIn){
        if(isLoggedIn){
          document.getElementById('logout').style.display = 'block';
          document.getElementById('login').style.display = 'none';
          document.getElementById('Wtext').style.display = 'none';
        } else {
          document.getElementById('logout').style.display = 'none';
          document.getElementById('login').style.display = 'block';
          document.getElementById('Wtext').style.display = 'block';
        }
      }

//SCREEN 1 
//==============================================================
    //banner 
    function banner(){

      var rect = canvas.append("rect")
        .attr("x", 0)
        .attr("y", 20)
        .attr("width", width)
        .attr("height", 100)
        .style("fill", "black");

      var text = canvas.append("text")
        .attr("x", 50)
        .attr("y", 95)
        .text("WELCOME TO IDENTITY 2.0")
        .style("font", "75px 'stellar'")
        .style("fill", "white");

    }// end of banner function 


//==============================================================

//************************************************************
// ============= SCREENS FOR FACEBOOK REVIEW =================
//************************************************************

//SCREEN 2 
//==============================================================
    function theProfile(){

    document.getElementById('next2').style.visibility = 'hidden';
    document.getElementById('Ads').style.visibility = 'hidden';
    document.getElementById('Vis').style.visibility = 'hidden';
    document.getElementById('endB').style.visibility = 'hidden';

      var yStart = 260; 
      var spacer = 50;
     // var fontSize = 30; 

      var rect = canvas.append("rect")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", width)
        .attr("height", height)
        .style("fill", "white");

      FB.api('/me', 'GET', {fields: 'name,id,gender,hometown,birthday,location,picture.width(100).height(100),tagged_places.limit(100),groups.limit(100),television.limit(100),friends.limit(100),likes.limit(100)'}, function(response) {

   
      var rect = canvas.append("rect")
        .attr("x", 0)
        .attr("y", 20)
        .attr("width", width)
        .attr("height", 100)
        .style("fill", "black");

      var text = canvas.append("text")
        .attr("x", 50)
        .attr("y", 95)
        .text("IDENTITY 2.0")
        .style("font", "75px 'stellar'")
        .style("fill", "white");

      canvas.append("text")
        .attr("x", 50)
        .attr("y", 180)
        .text("YOUR DATA PROFILE")
        .style("font", "30px 'stellar'")
        .style("fill", "black");

      canvas.append("text")
        .attr("x", 50)
        .attr("y", 220)
        .text("--------------------------------------------------------------------")
        .style("font", "20px 'stellar'")
        .style("fill", "black");

      canvas.append("text")
        .attr("x", 50)
        .attr("y", yStart)
        .text("NAME:" + " " + response.name)
        .style("font", "30px 'stellar'")
        .style("fill", "black");

      canvas.append("text")
        .attr("x", 50)
        .attr("y", (yStart + spacer))
        .text("USER ID:" + " " + response.id)
        .style("font", "30px 'stellar'")
        .style("fill", "black");

      canvas.append("text")
        .attr("x", 50)
        .attr("y", (yStart + (spacer*2)))
        .text("DATE OF BIRTH:" + " " + response.birthday)
        .style("font", "30px 'stellar'")
        .style("fill", "black");

      canvas.append("text")
        .attr("x", 50)
        .attr("y", (yStart + (spacer*3)))
        .text("GENDER:" + " " + response.gender)
        .style("font", "30px 'stellar'")
        .style("fill", "black");

console.log(response.hometown); 
     var homeInfo = response.hometown; 
      canvas.append("text")
        .attr("x", 50)
        .attr("y", (yStart + (spacer*4)))
        .text("HOMETOWN:" + " " + homeInfo.name)
        .style("font", "30px 'stellar'")
        .style("fill", "black"); 

      canvas.append("text")
        .attr("x", 50)
        .attr("y", (yStart + (spacer*5)))
        .text("LOCATION:" + " " + response.location.name)
        .style("font", "30px 'stellar'")
        .style("fill", "black");

      canvas.append("text")
        .attr("x", 50)
        .attr("y", (yStart + (spacer*6)))
        .text("PROFILE PICTURE:")
        .style("font", "30px 'stellar'")
        .style("fill", "black"); 

        document.getElementById('status').innerHTML = "<img class = img src='" + response.picture.data.url + "'>";

    var friendsInfo = response.friends;
    var friendsInfo2 = friendsInfo.summary;
    //console.log(friendsInfo2.total_count); 

        canvas.append("text")
        .attr("x", 50)
        .attr("y", (yStart + (spacer*10)))//needs to calculate space that was taken up above
        .text("YOUR INFLUENCE: ")
        .style("font", "30px 'stellar'")
        .style("fill", "black"); 

        canvas.append("text")
        .attr("x", 100)
        .attr("y", (yStart + (spacer*10) + 50))//needs to calculate space that was taken up above
        .text("FRIEND COUNT: " + friendsInfo2.total_count)
        .style("font", "30px 'stellar'")
        .style("fill", "black"); 

      });//end of api function 

    }//end of profile function

//==============================================================

//----

//==============================================================

function page3(){

  document.getElementById('next').style.visibility = 'hidden';
  document.getElementById('Ads').style.visibility = 'hidden';
  document.getElementById('Vis').style.visibility = 'hidden';
  document.getElementById('endB').style.visibility = 'hidden';

  document.getElementById('next2').style.visibility = 'visible';

  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;

  var radius = 50; 

  document.getElementById('status').style.visibility = 'hidden';
    var rect = canvas.append("rect")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", width)
        .attr("height", 10300) //needs to be depended on data height of each person
        .style("fill", "white");

var spaceT = 1; 

      for (var i = 0; i < 1000; i++) {

        var text1 = canvas.append("text")
        .attr("x", 0)
        .attr("y", 10*spaceT)
        .text("YOU'VE BEEN PROCESSED,YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED,YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED, YOU'VE BEEN PROCESSED")
      .style("font", "10px 'stellar'")
      .style("fill", "black"); 

      spaceT++; 
      }; //end of for loop


    d3.selectAll("text")
    .style("opacity", 0)
    .transition()
    .delay(function(d,i){ return 100*i; }) //controls how many come on the screen
    .duration(200) //controls how fast is changes opacity
    .style("opacity", 1.0);


    canvas.append("rect")
      .attr("x", 70)
      .attr("y", 220)
      .attr("width", 550)
      .attr("height", 500)
      .style("fill", "white")
      .style("stroke", "black");


    canvas.append("rect")
      .attr("x", 50)
      .attr("y", 240)
      .attr("width", 550)
      .attr("height", 500)
      .style("fill", "black"); 

    var text = canvas.append("text")
      .attr("x", 60)
      .attr("y", 280)
      .text("Companies and Advertisers can also access your: " )
      .style("font", "15px 'stellar'")
      .style("fill", "white");

  var names = [ '- Likes',  '- Groups (even private ones)','- Friend lists','- External websites that you redirected to from facebook', '- Tagged Locations','- Your current location (remember when you allowed gps access)'];

    var tSpace = 20; 

    for (var j = 0; j < 6; j++) {

      canvas.append("text")
        .attr("x", 60)
        .attr("y", 120 +(tSpace*10))
        .text(names[j])
        .style("font", "15px 'stellar'")
        .style("fill", "white");  

        tSpace++;
        tSpace = tSpace + 2; 

    } //end of for loop

    canvas.append("text")
      .attr("x",60)
      .attr("y", 520)
      .text("We wanted to show you all of this!")
      .style("font", "15px 'stellar'")
      .style("fill", "white"); 

    canvas.append("text")
      .attr("x",60)
      .attr("y", 550)
      .text("But facebook rejected our request because we are not a real verified company …")
      .style("font", "15px 'stellar'")
      .style("fill", "white"); 

} //end of page3 function

//==============================================================  
 
//----

//==============================================================

function statement(){


  document.getElementById('next2').style.visibility = 'hidden';
  document.getElementById('Vis').style.visibility = 'hidden';
  document.getElementById('Ads').style.visibility = 'visible';
  document.getElementById('endB').style.visibility = 'hidden';

  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;

  document.getElementById('status').style.visibility = 'hidden';
    var rect = canvas.append("rect")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", width)
        .attr("height", 1000)
        .style("fill", "white");

      var text = canvas.append("text")
      .attr("x",50)
      .attr("y", 120)
      .text("FACEBOOK IS FREE FOR ITS USERS BECAUSE IT MAKES MONEY") //$7437 every minute 
      .style("font", "40px 'stellar'")
      .style("fill", "black");

    canvas.append("text")
      .attr("x",50)
      .attr("y", 240)
      .text("FROM DIGITAL AD'S THAT USE OUR DATA")
      .style("font", "40px 'stellar'")
      .style("fill", "black");

}// end of statement function


//============================================================== 

    
  
function fact(){

  document.getElementById('Vis').style.visibility = 'visible';
  document.getElementById('Ads').style.visibility = 'hidden';
  document.getElementById('endB').style.visibility = 'hidden';

document.body.scrollTop = 0;
document.documentElement.scrollTop = 0;

    var rect = canvas.append("rect")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", width)
        .attr("height", 1000)
        .style("fill", "black");

    var text = canvas.append("text")
      .attr("x",50)
      .attr("y", 120)
      .text("FACEBOOK MAKES $22,311")
      .style("font", "80px 'stellar'")
      .style("fill", "white");


    canvas.append("text")
      .attr("x",50)
      .attr("y", 240)
      .text("FROM DIGITAL AD'S")
      .style("font", "80px 'stellar'")
      .style("fill", "white");


    var newText = canvas.append("text")
      .attr("x",50)
      .attr("y", height - 130)
      .text("IN THE PAST 3 MINUTES")
      .style("font", "100px 'stellar'")
      .style("opacity", 0)
      .transition()
      .delay(function(d,i){ return 700*i; }) //controls how many come on the screen
      .duration(2000) //controls how fast is changes opacity
      .style("opacity", 1.0)
      .style("fill", "white"); 

    } // end of fact function

//============================================================== 

//

//==============================================================

function generalVis(){

  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;


  var fontS = 40; 
  var spaceF = 30; 
  var yP = 200; 

  document.getElementById('status').style.visibility = 'hidden';
  document.getElementById('next2').style.visibility = 'hidden';
  document.getElementById('Ads').style.visibility = 'hidden';
  document.getElementById('Vis').style.visibility = 'hidden';
  document.getElementById('endB').style.visibility = 'visible';


    var rect = canvas.append("rect")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", width)
        .attr("height", 1000)
        .style("fill", "white");


  var text = canvas.append("text")
    .attr("x", 30)
    .attr("y", 65)
    .text("BUT FACEBOOK IS NOT THE ONLY DIGITAL PLATFORM...")

    canvas.append("text")
      .attr("x",30)
      .attr("y", yP)
      .text("FACEBOOK: ") //$7437 every minute 
      .style("font", "40px 'stellar'")
      .style("fill", "black");

      canvas.append("text")
      .attr("x",30)
      .attr("y", yP + (fontS + spaceF))
      .text("TWITTER: ") //$7437 every minute 
      .style("font", "40px 'stellar'")
      .style("fill", "black");

      canvas.append("text")
      .attr("x",30)
      .attr("y", yP + (fontS + spaceF)*2)
      .text("YOUTUBE: ") //$7437 every minute 
      .style("font", "40px 'stellar'")
      .style("fill", "black");

      canvas.append("text")
      .attr("x",30)
      .attr("y", yP + (fontS + spaceF)*3)
      .text("REDDIT: ") //$7437 every minute 
      .style("font", "40px 'stellar'")
      .style("fill", "black");


      canvas.append("text")
      .attr("x",30)
      .attr("y", yP + (fontS + spaceF)*4)
      .text("Just to give a few examples") //$7437 every minute 
      .style("font", "20px 'stellar'")
      .style("fill", "black");

      // canvas.append("text")
      // .attr("x",30)
      // .attr("y", yP + (fontS + spaceF)*5)
      // .text("YOU'VE REACHED THE END OF YOUR VISULISATION!") 
      // .style("font", "20px 'stellar'")
      // .style("fill", "black");

      // canvas.append("text")
      // .attr("x",30)
      // .attr("y", yP + ((fontS + spaceF)*5) + (20 + spaceF))
      // .text("THANKS FOR COMING ALONG! - IDENTITY 2.0") 
      // .style("font", "20px 'stellar'")
      // .style("fill", "black");

}// end of GeneralVis function

//==============================================================


function end(){

  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;

  document.getElementById('status').style.visibility = 'hidden';
  document.getElementById('next2').style.visibility = 'hidden';
  document.getElementById('Ads').style.visibility = 'hidden';
  document.getElementById('Vis').style.visibility = 'hidden';
  document.getElementById('endB').style.visibility = 'hidden';


var rect = canvas.append("rect")
  .attr("x", 0)
  .attr("y", 0)
  .attr("width", width)
  .attr("height", 1000)
  .style("fill", "white");

var text = canvas.append("text")
  .attr("x", 80)
  .attr("y", 200)
  .text("OUR DATA")
  .style("font", "60px 'stellar'")
  .style("fill", "black");


// var Ytext = canvas.append("text")
//   .attr("x", 50)
//   .attr("y", 200)
//   .text("Y")
//   .style("font", "60px 'stellar'")
//   .style("fill", "black")

// for (var t = 0; t < 2000; t++) {

//     d3.selectAll("Ytext")
//     .style("opacity", 0)
//     .transition()
//     .delay(function(d,i){ return 100*i; }) //controls how many come on the screen
//     .duration(200*t) //controls how fast is changes opacity
//     .style("opacity", 1.0)
//     .remove()


// }// end of for loop


  var Ytext = canvas.append("text")
    .attr("x", 50)
    .attr("y", 200)
    .text("Y")
    .style("font", "60px 'stellar'")
    .style("fill", "black")
      repeat();


    function repeat() {
      Ytext
        .style("opacity", 0)
        .transition()        // apply a transition
        .duration(2000)      // apply it over 2000 milliseconds
        .style("opacity", 1.0)
        .transition()        // apply a transition
        .duration(2000)      // apply it over 2000 milliseconds
        .style("opacity", 0)
        .on("end", repeat);  // when the transition finishes start again
    };



// for (var t = 0; t < 2000; t++) {

//   canvas.append("text")
//     .attr("x", 50)
//     .attr("y", 200)
//     .text("Y")
//     .style("font", "60px 'stellar'")
//     .style("fill", "black")
//     .style("opacity", 0)
//     .transition()
//     .delay(function(d,i){ return 100*i; }) //controls how many come on the screen
//     .duration(200*t) //controls how fast is changes opacity
//     .style("opacity", 1.0)
//     .on("end", repeat); 


// }// end of for loop


} //end of the function



function fbLogout() {

        FB.logout(function (response) {
            //Do what ever you want here when logged out like reloading the page
            window.location.reload();
        });
    }

//============================================================== 


//************************************************************
// ============= SCREENS FOR FACEBOOK REVIEW =================
//************************************************************
// ========================= END =============================

</script>

<p id="Wtext"> Welcome to the exhibition Identity 2.0. By logging into Facebook you give us premission to use your data to generate visulisations. These visulisations will help you explore your digital Identity! </p>

<div id = "status"></div>

<fb:login-button
	id="login" 
	scope ="public_profile,user_birthday,user_gender,user_hometown,user_location,user_friends" 
	onclick = "statusChangeCallback();" >
</fb:login-button>

<button 
	class = "button2"
	id="logout" 
	onclick="fbLogout()">Logout
</button> 

<button 
	class = "button3"
	id="next" 
	onclick="page3()">Continue
</button> 

<button 
  class = "button3"
  id="next2" 
  onclick="statement()">Continue
</button> 

<button 
  class = "button4"
  id="Ads" 
  onclick="fact()">Show me the money
</button> 

<button 
  class = "button5"
  id="Vis" 
  onclick=" generalVis()">Wait, there's more? 
</button> 

<button 
  class = "button3"
  id="endB" 
  onclick=" end()">Continue 
</button> 

</body>
</html> 